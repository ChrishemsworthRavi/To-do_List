<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        // Import Supabase SDK
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/umd/supabase.js";

        // Supabase configuration
        const SUPABASE_URL = "https://dnbgjzscuxrlbceqsrhz.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRuYmdqenNjdXhybGJjZXFzcmh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4NDU1MTksImV4cCI6MjA1ODQyMTUxOX0.ZJ496AtjazuXkppkpEy-DnChkUdsAme4DQXBC4sNTsg";
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        document.addEventListener("DOMContentLoaded", loadTasks);

        async function addTask() {
            let taskInput = document.getElementById("taskInput");
            let taskText = taskInput.value.trim();
            if (taskText === "") return;

            // Add task to Supabase
            await supabase.from("tasks").insert([{ text: taskText, completed: false }]);
            taskInput.value = "";
            loadTasks();
        }

        async function loadTasks() {
            let taskList = document.getElementById("taskList");
            taskList.innerHTML = "";

            let { data: tasks } = await supabase.from("tasks").select("*");
            tasks.forEach(task => {
                let li = document.createElement("li");
                li.className = "flex justify-between items-center bg-gray-200 px-3 py-2 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105";
                li.innerHTML = `
                    <div class="flex items-center gap-2">
                        <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="toggleComplete(${task.id}, this)" class="task-checkbox">
                        <span class="task-text ${task.completed ? 'line-through text-gray-500 opacity-50' : ''}">${task.text}</span>
                    </div>
                    <button onclick="removeTask(${task.id})" class="bg-red-500 text-white px-2 py-1 rounded-lg hover:bg-red-600 transition-all duration-300">X</button>`;
                taskList.appendChild(li);
            });
        }

        async function removeTask(id) {
            await supabase.from("tasks").delete().match({ id: id });
            loadTasks();
        }

        async function toggleComplete(id, checkbox) {
            let completed = checkbox.checked;
            await supabase.from("tasks").update({ completed: completed }).match({ id: id });
            loadTasks();
        }

        function toggleTheme() {
            document.body.classList.toggle("bg-gray-900");
            document.body.classList.toggle("text-black");
        }
    </script>
</head>
<body class="bg-gray-100 text-gray-900 transition-colors duration-300">
    <div class="max-w-md mx-auto mt-10 bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-3xl font-bold text-center mb-4 text-blue-600 animate-pulse">To-Do List</h2>
        <div class="flex gap-2">
            <input type="text" id="taskInput" placeholder="Add a new task" class="flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 transition-all duration-300">
            <button onclick="addTask()" class="bg-blue-500 text-black px-4 py-2 rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105">Add</button>
        </div>
        <button onclick="toggleTheme()" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition-transform transform hover:scale-105">Toggle Theme</button>
        <ul id="taskList" class="mt-4 space-y-2"></ul>
    </div>
</body>
</html>